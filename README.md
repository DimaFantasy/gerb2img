# Gerb2Img

`Gerb2Img` ‚Äî —ç—Ç–æ –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ –∏ —É—Ç–∏–ª–∏—Ç–∞ –¥–ª—è –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è —Ñ–∞–π–ª–æ–≤ Gerber RS-274X –≤ —Ä–∞—Å—Ç—Ä–æ–≤—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤ —Ñ–æ—Ä–º–∞—Ç–∞—Ö TIFF –∏–ª–∏ BMP. –≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç –æ—Å–Ω–æ–≤–∞–Ω –Ω–∞ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–º –∫–æ–¥–µ `gerb2tiff-1.2`, —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–Ω–Ω–æ–º Adam Seychell (2001). –û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π –ø—Ä–æ–µ–∫—Ç –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–ª —Å–æ–±–æ–π –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–π —Ñ–∞–π–ª (.exe) –∏ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–ª —Ç–æ–ª—å–∫–æ —Ñ–æ—Ä–º–∞—Ç TIFF. –ü—Ä–æ–µ–∫—Ç gerb2tiff-1.2 –±–æ–ª—å—à–µ –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è –∏ –Ω–µ —Ä–∞–∑–≤–∏–≤–∞–µ—Ç—Å—è.

–ü—Ä–æ–µ–∫—Ç –±—ã–ª –ø–µ—Ä–µ—Ä–∞–±–æ—Ç–∞–Ω –≤ –±–∏–±–ª–∏–æ—Ç–µ–∫—É DLL –∏ —É—Ç–∏–ª–∏—Ç—É EXE, —á—Ç–æ –¥–µ–ª–∞–µ—Ç –µ–≥–æ —É–¥–æ–±–Ω—ã–º –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤ –ª—é–±—ã—Ö –ø—Ä–æ–µ–∫—Ç–∞—Ö –Ω–∞ C++, Delphi, Python –∏ –¥—Ä—É–≥–∏—Ö —è–∑—ã–∫–∞—Ö. –¢–∞–∫–∂–µ –±—ã–ª–∏ —É—Å—Ç—Ä–∞–Ω–µ–Ω—ã –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä–∞, –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –±–∞–≥–∏, –¥–æ–±–∞–≤–ª–µ–Ω–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∞ —Ñ–æ—Ä–º–∞—Ç–∞ BMP (–¥–ª—è DLL) –∏ —É–ª—É—á—à–µ–Ω–∞ —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å.

## –û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è Gerber-—Ñ–∞–π–ª–æ–≤ –≤ –º–æ–Ω–æ—Ö—Ä–æ–º–Ω—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è:
  - DLL –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Ñ–æ—Ä–º–∞—Ç—ã TIFF –∏ BMP (–≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è –≤—ã—Ö–æ–¥–Ω–æ–≥–æ —Ñ–∞–π–ª–∞).
  - EXE –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Ç–æ–ª—å–∫–æ —Ñ–æ—Ä–º–∞—Ç TIFF.
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤: DPI, –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ, –∏–Ω–≤–µ—Ä—Å–∏—è –ø–æ–ª—è—Ä–Ω–æ—Å—Ç–∏, –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –≥—Ä–∞–Ω–∏—Ü.
- –≠–∫—Å–ø–æ—Ä—Ç —Ñ—É–Ω–∫—Ü–∏–π –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤ –¥—Ä—É–≥–∏—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è—Ö —á–µ—Ä–µ–∑ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å DLL:
  - `processGerber`: –û—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ Gerber-—Ñ–∞–π–ª–æ–≤.
  - `processGerberJSON`: –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –≤ —Ñ–æ—Ä–º–∞—Ç–µ JSON.

## –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### Python (—á–µ—Ä–µ–∑ ctypes)
```python
import ctypes

# –ó–∞–≥—Ä—É–∑–∫–∞ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏
gerb2img = ctypes.WinDLL("gerb2img.dll")

# –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ processGerber
processGerber = gerb2img.processGerber
processGerber.argtypes = [
    ctypes.c_double, ctypes.c_bool, ctypes.c_bool, ctypes.c_double,
    ctypes.c_bool, ctypes.c_uint, ctypes.c_double, ctypes.c_double,
    ctypes.c_double, ctypes.c_char_p, ctypes.c_char_p
]
processGerber.restype = ctypes.c_int

# –í—ã–∑–æ–≤ —Ñ—É–Ω–∫—Ü–∏–∏
result = processGerber(
    2400.0, False, False, 0.0, False, 512, 0.0, 1.0, 1.0,
    b"output.bmp", b"example.gbr"
)

if result == 0:
    print("Conversion successful!")
else:
    print("Conversion failed!")
```

### Delphi
```delphi
library Gerb2ImgDemo;

uses
  Windows, SysUtils;

type
  TProcessGerber = function(
    DPI: Double; Invert: Boolean; Mirror: Boolean; Rotation: Double;
    AddBorder: Boolean; BorderSize: Cardinal; ScaleX, ScaleY, OffsetX: Double;
    OutputFile, InputFile: PAnsiChar
  ): Integer; stdcall;

var
  Gerb2ImgLib: THandle;
  ProcessGerber: TProcessGerber;

begin
  Gerb2ImgLib := LoadLibrary('gerb2img.dll');
  if Gerb2ImgLib = 0 then
    raise Exception.Create('–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å gerb2img.dll');

  @ProcessGerber := GetProcAddress(Gerb2ImgLib, 'processGerber');
  if not Assigned(ProcessGerber) then
    raise Exception.Create('–ù–µ —É–¥–∞–ª–æ—Å—å –Ω–∞–π—Ç–∏ —Ñ—É–Ω–∫—Ü–∏—é processGerber');

  try
    if ProcessGerber(2400.0, False, False, 0.0, False, 512, 0.0, 1.0, 1.0,
      'output.bmp', 'example.gbr') = 0 then
      Writeln('–ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è —É—Å–ø–µ—à–Ω–∞!')
    else
      Writeln('–û—à–∏–±–∫–∞ –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏!');
  finally
    FreeLibrary(Gerb2ImgLib);
  end;
end.
```

## –î–µ–º–æ

–í –ø—Ä–æ–µ–∫—Ç –≤–∫–ª—é—á–µ–Ω—ã –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ –ø—Ä–∏–º–µ—Ä—ã –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∏:
- **Delphi**: –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è DLL –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ Gerber-—Ñ–∞–π–ª–æ–≤.
- **Python**: –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —á–µ—Ä–µ–∑ `ctypes`.

## –°–±–æ—Ä–∫–∞

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è
- –ö–æ–º–ø–∏–ª—è—Ç–æ—Ä —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π C++11 –∏–ª–∏ –≤—ã—à–µ.
- –ë–∏–±–ª–∏–æ—Ç–µ–∫–∏:
  - [libtiff](http://www.libtiff.org/)
  - [EasyBMP](http://easybmp.sourceforge.net/) - –£–∂–µ –µ—Å—Ç—å
  - [nlohmann/json](https://github.com/nlohmann/json) - –£–∂–µ –µ—Å—Ç—å

## üîß –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ —Å–±–æ—Ä–∫–µ –ø–æ–¥ Windows (MinGW)

### 1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å `libtiff` (–æ—Å—Ç–∞–ª—å–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —É–∂–µ –≤–∫–ª—é—á–µ–Ω—ã –≤ –ø—Ä–æ–µ–∫—Ç):

- –î–ª—è **64-–±–∏—Ç–Ω–æ–π —Å—Ä–µ–¥—ã MinGW**:
  ```bash
  pacman -S mingw-w64-x86_64-libtiff
  ```

- –î–ª—è **32-–±–∏—Ç–Ω–æ–π —Å—Ä–µ–¥—ã MinGW**:
  ```bash
  pacman -S mingw-w64-i686-libtiff
  ```

### 2. –°–∫–æ–º–ø–∏–ª–∏—Ä—É–π—Ç–µ –ø—Ä–æ–µ–∫—Ç:

- –ó–∞–ø—É—Å—Ç–∏—Ç–µ `mingw64.exe` (–¥–ª—è 64-bit) –∏–ª–∏ `mingw32.exe` (–¥–ª—è 32-bit).
- –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –ø–∞–ø–∫—É –ø—Ä–æ–µ–∫—Ç–∞:
  ```bash
  cd gerb2img
  ```
- –í—ã–ø–æ–ª–Ω–∏—Ç–µ —Å–±–æ—Ä–∫—É:
  ```bash
  make
  ```

### üí° –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã:
- `make`             ‚Äî –°–±–æ—Ä–∫–∞ release DLL –∏ EXE –¥–ª—è —Ç–µ–∫—É—â–µ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã (x32 –∏–ª–∏ x64).
- `make debug`       ‚Äî –°–±–æ—Ä–∫–∞ debug DLL –∏ EXE.
- `make clean`       ‚Äî –£–¥–∞–ª–µ–Ω–∏–µ –≤—Å–µ—Ö —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤.

### üîß –û—Ç–¥–µ–ª—å–Ω—ã–µ —Ü–µ–ª–∏:
- `make dll`         ‚Äî –¢–æ–ª—å–∫–æ release DLL.
- `make exe`         ‚Äî –¢–æ–ª—å–∫–æ release EXE.
- `make dll_debug`   ‚Äî –¢–æ–ª—å–∫–æ debug DLL.
- `make exe_debug`   ‚Äî –¢–æ–ª—å–∫–æ debug EXE.

## –õ–∏—Ü–µ–Ω–∑–∏—è

–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—è–µ—Ç—Å—è –ø–æ–¥ –ª–∏—Ü–µ–Ω–∑–∏–µ–π [GNU General Public License v3](https://www.gnu.org/licenses/gpl-3.0.txt).

## –ë–ª–∞–≥–æ–¥–∞—Ä–Ω–æ—Å—Ç–∏

- Adam Seychell –∑–∞ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π –ø—Ä–æ–µ–∫—Ç `gerb2tiff-1.2`.
- –°–æ–æ–±—â–µ—Å—Ç–≤–æ Open Source –∑–∞ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ –∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã.

## –ë—É–¥—É—â–µ–µ –ø—Ä–æ–µ–∫—Ç–∞

–ü—Ä–æ–µ–∫—Ç –±—É–¥–µ—Ç –∞–∫—Ç–∏–≤–Ω–æ —Ä–∞–∑–≤–∏–≤–∞—Ç—å—Å—è. –í –ø–ª–∞–Ω–∞—Ö:
- –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø–æ–¥–¥–µ—Ä–∂–∫–∏ —Ñ–æ—Ä–º–∞—Ç–∞ BMP –¥–ª—è EXE.
- –£–ª—É—á—à–µ–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∏ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏.
- –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ –∏ –ø—Ä–∏–º–µ—Ä–æ–≤ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è.

